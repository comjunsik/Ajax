# UserDAO.java
회원 등록 함수
```java
public int register(User user) {
		String SQL = "INSERT INTO USER VALUES (?, ?, ?, ?)";
		try {
			pstmt = conn.prepareStatement(SQL);
			pstmt.setString(1, user.getUserName());
			pstmt.setInt(2, user.getUserAge());
			pstmt.setString(3, user.getUserGender());
			pstmt.setString(4, user.getUserEmail());
			return pstmt.executeUpdate();
		}catch(Exception e) {
			e.printStackTrace();
		}
		return -1;
	}
```
회원 정보가 들어 있는 User.java 클래스를 파라미터로 받는 함수를 생성한다.
반환형이 int 인 이유는
INSERT, UPDATE 등의 SQL문의 반환값은 0이상의 값 int 값이기 때문이다.
따라서 반환값이 0 보다 작을 겨우는 db오류 이기 때문에
return -1;을 하여 db오류라는 것을 알린다.

---

# UserRegisterServlet.java
회원정보 등록 서블릿

```java
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		request.setCharacterEncoding("UTF-8");
		response.setContentType("text/html;charset=UTF-8");
		String userName = request.getParameter("userName");
		String userAge = request.getParameter("userAge");
		String userGender = request.getParameter("userGender");
		String userEmail = request.getParameter("userEmail");
		response.getWriter().write(register(userName, userAge, userGender, userEmail) + "");
	}
	
	public int register(String userName, String userAge, String userGender, String userEmail) {
		User user = new User();
		try {
			user.setUserName(userName);
			user.setUserAge(Integer.parseInt(userAge));
			user.setUserGender(userGender);
			user.setUserEmail(userEmail);
		} catch(Exception e) {
			return 0;
		}
		
		return new UserDAO().register(user);
	}
```
```java
response.getWriter().write(register(userName, userAge, userGender, userEmail) + "");
```
resopnse시 write() 메소드는 문자열을 매개변수로 가지기 때문에 끝에 빈문자열 ""을 더해 주어 문자열로 바꾸어주었다.

<br>

```java
User user = new Usre();

return new UserDAO().register(user);
```
User의 인스턴스 생성 후 
return으로
회원 정보를 담은
User의 인스턴스를 매개변수로 넘기면서 register() 메소드를 실행시켜 준다.

성공적으로 수행이 됬다면 return 값은 1이다.
왜냐하면 UserDAO().register()을 수행하게 되면 SQL문 INSERT를 수행하게 되는데 하나의 레코드를 테이블에 INSERT하게 되면
pstmt.excuteUpate()시 리턴 값은 1이기 때문이다.
즉, INSERT문 수행시 반환값은 저장된 레코드의 수이다.


---

# index.jsp
회원등록 js
```js
function registerFunction(){
			registerRequest.open("POST", "./UserRegisterServlet?userName=" + encodeURIComponent(document.getElementById("registerName").value) +
										"&userAge="  + encodeURIComponent(document.getElementById("registerAge").value) +
										"&userGender="  + encodeURIComponent($('input[name=registerGender]:checked').val()) +
										"&userEmail="  + encodeURIComponent(document.getElementById("registerEmail").value), true);
			registerRequest.onreadystatechange = registerProcess;
			registerRequest.send(null);
		}
		function registerProcess(){
			if(registerRequest.readyState == 4 && registerRequest.status ==200){
				var result = registerRequest.responseText;
				if(result !=1){
					alert('등록이 실패했습니다.');
				}
				else{
					var userName = document.getElementById("userName");
					var registerName = document.getElementById("registerName");
					var registerAge = document.getElementById("registerAge");
					var registerEmail = document.getElementById("registerEmail");
					userName.value = "";
					registerName.value = "";
					registerAge.value = "";
					registerEmail.value = "";
					searchFunction();
				}
			}
		}
		window.onload = function(){
			searchFunction();
		}
```

```js
"&userGender="  + encodeURIComponent($('input[name=registerGender]:checked').val())
```

jquery문으로 작성하지 않고
document.getElementsByName()으로 수행할시
document.getElementsByName().checked 를 사용하여 체크가 되었는지 확인 한 후
document.getElementsByName().value를 통해 값을 가져와야 함으로 코드가 복잡해 진다.
즉
```js
if(document.getElementsByName().checked ){
    return document.getElementsByName().value
}
```

로 코드를 짜야한다.

```js
var result = registerRequest.responseText;
if(result !=1){
	alert('등록이 실패했습니다.');
}
else{
	var userName = document.getElementById("userName");
	var registerName = document.getElementById("registerName");
	var registerAge = document.getElementById("registerAge");
	var registerEmail = document.getElementById("registerEmail");
		userName.value = "";
		registerName.value = "";
		registerAge.value = "";
		registerEmail.value = "";
		searchFunction();
}
```

```js
if(result !=1){
	alert('등록이 실패했습니다.');
}
```
UserSearchServlet에서 받은 respose값은 성겅적으로 수행됬다면 1 이기 때문에.
왜냐하면 위에 설명 했듯이 UserSearchServlet.register()의 반환값은 성공시 1이기 때문에.

```js
searchFunction();
```
view에서 보여주는 모든 값들을 초기화 시켜준 후.
searchFunction()을 호출하여 새롭게 추가된 정보와 함께 화면에 뿌려준다.